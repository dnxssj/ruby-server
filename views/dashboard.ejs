<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title><%= user.username %> - Dashboard</title>
    <link rel="icon" type="image/x-icon" href="/images/ruby.ico">
    <link rel="stylesheet" href="/styles.css?v=6">
    
</head>
<body>
    <header>
        <a href="/"><img src="/images/logo.png" alt="Ruby Server Logo"></a>
    </header>
    <nav>
        <div class="nav-container">
            <ul class="main-nav">
                <li><a href="/">Inicio</a></li>
                <li><a href="/jugadores">Top All Time</a></li>
                <li><a href="/clanes">Clanes</a></li>
                <li><a href="/actual">Top Actual</a></li>
                <li><a href="/guestbook">Guestbook</a></li>
                <li><a href="/hemeroteca">Hemeroteca</a></li>
            </ul>
            <ul class="user-nav">
                <% if (!user) { %> <!-- Si no hay un usuario autenticado -->
                    <li><a href="/register">Registrar</a></li>
                    <li><a href="/login">Iniciar sesión</a></li>
                    <% } else { %> <!-- Si hay un usuario autenticado -->
                            <li><a href="/dashboard">Dashboard</a></li>
                            <% if (user.role === "admin") { %><li><a href="/housekeeping">Housekeeping</a></li><% } %>
                            <li><form action="/logout" method="POST" style="display: inline;">
                                    <button type="submit" class="logout-btn">Cerrar sesión</button>
                                </form></li>
                        <% } %>
            </ul>
        </div>
    </nav>
    <div id="popup" class="popup">
        <div class="popup-content">
            <p>Nota: Actualmente, la funcionalidad de subir imágenes de perfil no está disponible, pero puedes elegir una imagen predeterminada.</p>
            <button id="close-popup">Cerrar</button>
        </div>
    </div>
    
    <div class="centered-container">
        <h1>Bienvenido, <a href="/user/<%= user._id %>"><%= user.username %></a>!</h1>
        <form action="/dashboard" method="POST">
            <label for="bio">Actualizar biografía:</label>
            <p><textarea name="bio" rows="3" placeholder="Escribe tu biografía..."><%= user.bio %></textarea></p>
            
            <p>Selecciona una imagen de perfil:</p>
            <div class="profile-options">
                <% const profileImages = ["/images/profile-options/profile1.png", "/images/profile-options/profile2.png", "/images/profile-options/profile3.png", "/images/profile-options/profile4.png", "/images/profile-options/profile5.png", "/images/profile-options/profile6.png", "/images/profile-options/profile9.png", "/images/profile-options/profile11.png"]; %>
                <% profileImages.forEach((img) => { %>
                    <label class="profile-option">
                        <input type="radio" name="profilePicture" value="<%= img %>" <%= user.profilePicture === img ? "checked" : "" %> />
                        <img src="<%= img %>" alt="Imagen de perfil" />
                    </label>
                <% }); %>
            </div>
            
            <button type="submit">Guardar cambios</button>
        </form>

        <% if (success) { %>
            <p class="success-message">Cambios guardados con éxito</p>
        <% } %>
    </div>
    
    

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const popup = document.getElementById("popup");
            const closeButton = document.getElementById("close-popup");
    
            popup.style.visibility = "visible";
            popup.style.opacity = "1";
    
            closeButton.addEventListener("click", () => {
                popup.style.visibility = "hidden";
                popup.style.opacity = "0";
            });
        });
    </script>
    
    <script src="/js/script.js"></script>
    
</body>
</html>
